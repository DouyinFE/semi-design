@import "./animation.scss";
@import "./variables.scss";

$module: #{$prefix}-input;


.#{$module}-textarea-wrapper {
    box-sizing: border-box;
    display: inline-block;
    position: relative;
    width: 100%;
    border: $width-input_wrapper-border $color-input_default-border-default solid;
    border-radius: $radius-input_wrapper;
    vertical-align: bottom;
    background-color: $color-input_default-bg-default;
    transition: background-color $transition_duration-input-bg $transition_function-input-bg $transition_delay-input-bg,
    border $transition_duration-input-border $transition_function-input-border $transition_delay-input-border;

    &:hover {
        background-color: $color-input_default-bg-hover;
    }

    &-focus {
        background-color: $color-input_default-bg-focus;
        border: $width-input_wrapper_focus-border $color-input_default-border-focus solid;
        &:hover,
        &:active {
            background-color: $color-input_default-bg-focus;
        }
    }

    &:active {
        background-color: $color-input_default-bg-active;
    }

    .#{$module}-clearbtn {
        position: absolute;
        top: 0;
        min-width: $width-textarea-icon;
        color: $color-textarea-icon-default;
        right: $spacing-textarea-icon-right;
        height: $height-textarea-default;

        & > svg {
            pointer-events: none;
        }

        &:hover {
            cursor: pointer;

            .#{$prefix}-icon {
                color: $color-textarea-icon-hover;
            }
        }

        &-hidden {
            visibility: hidden;
        }
    }

    &-disabled, &-readonly {
        cursor: not-allowed;
        // border: $border-thickness-control $color-input_disabled-border-default solid;
        color: $color-input_disabled-text-default;
        background-color: $color-input_disabled-bg-default;

        &:hover {
            background-color: $color-input_disabled-bg-default;
        }

        &::placeholder {
            color: $color-input_disabled-text-default;
        }
    }

    &-readonly {
        cursor: text;
    }

    &-error {
        background-color: $color-input_danger-bg-default;
        border-color: $color-input_danger-border-default;

        &:hover {
            background-color: $color-input_danger-bg-hover;
            border-color: $color-input_danger-border-hover;
        }

        &.#{$module}-textarea-wrapper-focus {
            background-color: $color-input_danger-bg-focus;
            border-color: $color-input_danger-border-focus;
        }

        &:active {
            background-color: $color-input_danger-bg-active;
            border-color: $color-input_danger-border-focus;
        }
    }

    &-warning {
        background-color: $color-input_warning-bg-default;
        border-color: $color-input_warning-border-default;

        &:hover {
            background-color: $color-input_warning-bg-hover;
            border-color: $color-input_warning-border-hover;
        }

        &.#{$module}-textarea-wrapper-focus {
            background-color: $color-input_warning-bg-focus;
            border-color: $color-input_warning-border-focus;
        }

        &:active {
            background-color: $color-input_warning-bg-active;
            border-color: $color-input_warning-border-focus;
        }
    }

    // &-resize {
    //     resize: vertical;
    //     overflow: auto;

    //     .#{$module}-textarea {
    //         min-height: 52px;
    //         height: calc(100% - 24px);
    //     }
    // }
}

.#{$module}-textarea {
    position: relative;
    resize: none;
    // min-height: $height-input_default;
    padding: $spacing-textarea-paddingY $spacing-textarea-paddingX;

    @include shadow-0;
    @include font-size-regular;
    background-color: transparent;
    border: $width-textarea-border solid $color-textarea-border-default;
    vertical-align: bottom;
    width: 100%;
    outline: none;
    cursor: text;
    box-sizing: border-box;
    color: $color-input_default-text-default;

    &:hover {
        border-color: $color-textarea-border-hover;
    }

    &::placeholder {
        color: $color-input_placeholder-text-default;
    }

    &-showClear {
        padding-right: $spacing-textarea_withShowClear-paddingRight;
    }

    &-disabled, &-readonly {
        cursor: not-allowed;
        color: $color-input_disabled-text-default;
        background-color: transparent;

        &:hover {
            background-color: transparent;
        }

        &::placeholder {
            color: $color-input_disabled-text-default;
        }
    }

    &-readonly {
        cursor: text;
    }

    &-autosize {
        overflow: hidden;
    }

    &-counter {
        @include font-size-small;
        display: flex;
        flex-direction: column;
        justify-content: center;
        padding: $spacing-textarea_counter-paddingTop $spacing-textarea_counter-paddingRight $spacing-textarea_counter-paddingBottom $spacing-textarea_counter-paddingLeft;
        min-height: $height-textarea_counter;
        text-align: right;
        color: $color-input_counter-text-default;

        &-exceed {
            color: $color-input_counter_danger-text-default;
        }
    }

    // &-withLineNumbers 由组件运行时注入左侧内边距，无需静态样式
}

.#{$module}-textarea-borderless{
    &:not(:focus-within):not(:hover){
        background-color:transparent;
        border-color: transparent;
    }

    &:focus-within:not(:active){
        background-color:transparent;
    }

    &.#{$module}-textarea-wrapper-error:not(:focus-within){
        border-color: $color-input_danger-border-focus;
    }



    &.#{$module}-textarea-wrapper-warning:not(:focus-within){
        border-color: $color-input_warning-border-focus;
    }

    &.#{$module}-textarea-wrapper-error{
            .#{$module}-textarea-counter{
                color: $color-input_danger-border-focus;
            }
    }

    &.#{$module}-textarea-wrapper-warning{
        .#{$module}-textarea-counter{
            color: $color-input_warning-border-focus;
        }
    }

}

/* 行号容器与样式 */
.#{$module}-textarea-linenumbers {
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    width: var(--semi-input-textarea-linenumber-width, 40px);
    box-sizing: border-box;
    padding: $spacing-textarea-paddingY 8px; // 左右各 8px，与 paddingLeft 16px 配合
    background-color: transparent;
    color: $color-input_placeholder-text-default;
    text-align: right;
    overflow: hidden; /* 自身不出现横向滚动 */
    pointer-events: none; /* 避免遮挡交互 */
    font-variant-numeric: tabular-nums; // 等宽数字，避免数字宽度不一致
    z-index: 1; // 置于 textarea 之上，避免被内容覆盖
}

.#{$module}-textarea-linenumbers-content {
    /* 由父容器负责裁剪，这里需要让内容自然撑高以容纳所有行号 */
    position: relative;
    will-change: transform;
}

.#{$module}-textarea-linenumbers-item {
    line-height: var(--semi-input-textarea-lineheight, $height-input_default); /* 与文本行高一致（随变量） */
    white-space: nowrap;
}

@import "./rtl.scss";
